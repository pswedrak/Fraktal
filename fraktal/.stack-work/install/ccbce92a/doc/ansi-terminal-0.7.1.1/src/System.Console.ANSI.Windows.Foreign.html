<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_HADDOCK hide #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- | &quot;System.Win32.Console&quot; is really very impoverished, so I have had to do all the FFI myself.</span><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Console</span><span class="hs-operator">.</span><span class="hs-identifier">ANSI</span><span class="hs-operator">.</span><span class="hs-identifier">Windows</span><span class="hs-operator">.</span><span class="hs-identifier">Foreign</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-7"></a><span>        </span><span class="hs-comment">-- Re-exports from Win32.Types</span><span>
</span><a name="line-8"></a><span>        </span><span class="hs-identifier hs-type">BOOL</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WCHAR"><span class="hs-identifier hs-type">WCHAR</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">iNVALID_HANDLE_VALUE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nullHANDLE</span><span class="hs-special">,</span><span>
</span><a name="line-9"></a><span>        </span><span class="hs-identifier hs-type">SHORT</span><span class="hs-special">,</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- 'Re-exports from System.Win32.Console.Extra'</span><span>
</span><a name="line-12"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD_EVENT"><span class="hs-identifier hs-type">INPUT_RECORD_EVENT</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#kEY_EVENT"><span class="hs-identifier hs-var">kEY_EVENT</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier hs-type">KEY_EVENT_RECORD</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#UNICODE_ASCII_CHAR"><span class="hs-identifier hs-type">UNICODE_ASCII_CHAR</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#writeConsoleInput"><span class="hs-identifier hs-var">writeConsoleInput</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#getNumberOfConsoleInputEvents"><span class="hs-identifier hs-var">getNumberOfConsoleInputEvents</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#readConsoleInput"><span class="hs-identifier hs-var">readConsoleInput</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#charToWCHAR"><span class="hs-identifier hs-var">charToWCHAR</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cWcharsToChars"><span class="hs-identifier hs-var">cWcharsToChars</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_top"><span class="hs-identifier hs-var">rect_top</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_bottom"><span class="hs-identifier hs-var">rect_bottom</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_left"><span class="hs-identifier hs-var">rect_left</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_right"><span class="hs-identifier hs-var">rect_right</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_width"><span class="hs-identifier hs-var">rect_width</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_height"><span class="hs-identifier hs-var">rect_height</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">CONSOLE_CURSOR_INFO</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-type">CONSOLE_SCREEN_BUFFER_INFO</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-type">CHAR_INFO</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#sTD_INPUT_HANDLE"><span class="hs-identifier hs-var">sTD_INPUT_HANDLE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#sTD_OUTPUT_HANDLE"><span class="hs-identifier hs-var">sTD_OUTPUT_HANDLE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#sTD_ERROR_HANDLE"><span class="hs-identifier hs-var">sTD_ERROR_HANDLE</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#eNABLE_VIRTUAL_TERMINAL_INPUT"><span class="hs-identifier hs-var">eNABLE_VIRTUAL_TERMINAL_INPUT</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#eNABLE_VIRTUAL_TERMINAL_PROCESSING"><span class="hs-identifier hs-var">eNABLE_VIRTUAL_TERMINAL_PROCESSING</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_BLUE"><span class="hs-identifier hs-var">fOREGROUND_BLUE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_GREEN"><span class="hs-identifier hs-var">fOREGROUND_GREEN</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_RED"><span class="hs-identifier hs-var">fOREGROUND_RED</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_INTENSITY"><span class="hs-identifier hs-var">fOREGROUND_INTENSITY</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_WHITE"><span class="hs-identifier hs-var">fOREGROUND_WHITE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_INTENSE_WHITE"><span class="hs-identifier hs-var">fOREGROUND_INTENSE_WHITE</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_BLUE"><span class="hs-identifier hs-var">bACKGROUND_BLUE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_GREEN"><span class="hs-identifier hs-var">bACKGROUND_GREEN</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_RED"><span class="hs-identifier hs-var">bACKGROUND_RED</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_INTENSITY"><span class="hs-identifier hs-var">bACKGROUND_INTENSITY</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_WHITE"><span class="hs-identifier hs-var">bACKGROUND_WHITE</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_INTENSE_WHITE"><span class="hs-identifier hs-var">bACKGROUND_INTENSE_WHITE</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#cOMMON_LVB_REVERSE_VIDEO"><span class="hs-identifier hs-var">cOMMON_LVB_REVERSE_VIDEO</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cOMMON_LVB_UNDERSCORE"><span class="hs-identifier hs-var">cOMMON_LVB_UNDERSCORE</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#getStdHandle"><span class="hs-identifier hs-var">getStdHandle</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleScreenBufferInfo"><span class="hs-identifier hs-var">getConsoleScreenBufferInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleCursorInfo"><span class="hs-identifier hs-var">getConsoleCursorInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleMode"><span class="hs-identifier hs-var">getConsoleMode</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleTextAttribute"><span class="hs-identifier hs-var">setConsoleTextAttribute</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleCursorPosition"><span class="hs-identifier hs-var">setConsoleCursorPosition</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleCursorInfo"><span class="hs-identifier hs-var">setConsoleCursorInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleTitle"><span class="hs-identifier hs-var">setConsoleTitle</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleMode"><span class="hs-identifier hs-var">setConsoleMode</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#fillConsoleOutputAttribute"><span class="hs-identifier hs-var">fillConsoleOutputAttribute</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#fillConsoleOutputCharacter"><span class="hs-identifier hs-var">fillConsoleOutputCharacter</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#scrollConsoleScreenBuffer"><span class="hs-identifier hs-var">scrollConsoleScreenBuffer</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>        </span><span class="hs-identifier hs-var">withTString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">withHandleToHANDLE</span><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#ConsoleException"><span class="hs-identifier hs-type">ConsoleException</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">C</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Marshal</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Ptr</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Storable</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bits</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Exception</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Exception</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">throw</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 612</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-64"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-cpp">#if !MIN_VERSION_Win32(2,5,1)</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Concurrent</span><span class="hs-operator">.</span><span class="hs-identifier">MVar</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">StablePtr</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Exception</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bracket</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 612</span><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Handle</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Handle</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Handle__</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">FD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FD</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- A wrapper around an Int32</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-74"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">IOBase</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Handle</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Handle__</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">IOBase</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IOBase</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FD</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Just an Int32</span><span>
</span><a name="line-77"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-78"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-cpp">#if defined(i386_HOST_ARCH)</span><span>
</span><a name="line-81"></a><span class="hs-cpp"># define WINDOWS_CCONV stdcall</span><span>
</span><a name="line-82"></a><span class="hs-cpp">#elif defined(x86_64_HOST_ARCH)</span><span>
</span><a name="line-83"></a><span class="hs-cpp"># define WINDOWS_CCONV ccall</span><span>
</span><a name="line-84"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-85"></a><span class="hs-cpp"># error Unknown mingw32 arch</span><span>
</span><a name="line-86"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">--import System.Console.ANSI.Windows.Foreign.Compat</span><span>
</span><a name="line-89"></a><span class="hs-cpp">#if !MIN_VERSION_Win32(2,5,0)</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- Some Windows types missing from System.Win32 prior version 2.5.0.0</span><span>
</span><a name="line-91"></a><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">SHORT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CShort</span><span>
</span><a name="line-92"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-93"></a><span class="hs-keyword">type</span><span> </span><a name="WCHAR"><a href="System.Console.ANSI.Windows.Foreign.html#WCHAR"><span class="hs-identifier">WCHAR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CWchar</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">charToWCHAR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WCHAR"><span class="hs-identifier hs-type">WCHAR</span></a><span>
</span><a name="line-96"></a><a name="charToWCHAR"><a href="System.Console.ANSI.Windows.Foreign.html#charToWCHAR"><span class="hs-identifier">charToWCHAR</span></a></a><span> </span><a name="local-6989586621679047145"><a href="#local-6989586621679047145"><span class="hs-identifier">char</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ord</span><span> </span><a href="#local-6989586621679047145"><span class="hs-identifier hs-var">char</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- This is a FFI hack. Some of the API calls take a Coord, but that isn't a built-in FFI type so I can't</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- use it directly. Instead, I use UNPACKED_COORD and marshal COORDs into this manually. Note that we CAN'T</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- just use two SHORTs directly because they get expanded to 4 bytes each instead of just boing 2 lots of 2</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- bytes by the stdcall convention, so linking fails.</span><span>
</span><a name="line-103"></a><span class="hs-keyword">type</span><span> </span><a name="UNPACKED_COORD"><a href="System.Console.ANSI.Windows.Foreign.html#UNPACKED_COORD"><span class="hs-identifier">UNPACKED_COORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CInt</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- Field packing order determined experimentally: I couldn't immediately find a specification for Windows</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- struct layout anywhere.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">unpackCOORD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#UNPACKED_COORD"><span class="hs-identifier hs-type">UNPACKED_COORD</span></a><span>
</span><a name="line-108"></a><a name="unpackCOORD"><a href="System.Console.ANSI.Windows.Foreign.html#unpackCOORD"><span class="hs-identifier">unpackCOORD</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a name="local-6989586621679047146"><a href="#local-6989586621679047146"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679047147"><a href="#local-6989586621679047147"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679047147"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">shiftL</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047146"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679047146"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">peekAndOffset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-6989586621679047143"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679047143"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047143"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679047144"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><a name="peekAndOffset"><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier">peekAndOffset</span></a></a><span> </span><a name="local-6989586621679047148"><a href="#local-6989586621679047148"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-113"></a><span>    </span><a name="local-6989586621679047149"><a href="#local-6989586621679047149"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047148"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047149"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047148"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">plusPtr</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047149"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-identifier">pokeAndOffset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-6989586621679047141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679047141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679047142"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><a name="pokeAndOffset"><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier">pokeAndOffset</span></a></a><span> </span><a name="local-6989586621679047150"><a href="#local-6989586621679047150"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679047151"><a href="#local-6989586621679047151"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-identifier hs-var">poke</span><span> </span><a href="#local-6989586621679047150"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679047151"><span class="hs-identifier hs-var">item</span></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047150"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">plusPtr</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047151"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-keyword">data</span><span> </span><a name="COORD"><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier">COORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="COORD"><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier">COORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-123"></a><span>        </span><a name="coord_x"><a href="System.Console.ANSI.Windows.Foreign.html#coord_x"><span class="hs-identifier">coord_x</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span class="hs-special">,</span><span>
</span><a name="line-124"></a><span>        </span><a name="coord_y"><a href="System.Console.ANSI.Windows.Foreign.html#coord_y"><span class="hs-identifier">coord_y</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-8214565720323793009"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a name="local-6989586621679047137"><a href="#local-6989586621679047137"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679047138"><a href="#local-6989586621679047138"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679047137"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679047138"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-132"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a name="local-6989586621679047126"><a href="#local-6989586621679047126"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679047127"><a href="#local-6989586621679047127"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047126"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047127"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-133"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a name="local-6989586621679047128"><a href="#local-6989586621679047128"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alignment</span><span> </span><a href="#local-6989586621679047128"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-134"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679047129"><a href="#local-6989586621679047129"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-135"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679047130"><a href="#local-6989586621679047130"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047129"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span>
</span><a name="line-136"></a><span>        </span><a name="local-6989586621679047131"><a href="#local-6989586621679047131"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peekElemOff</span><span> </span><a href="#local-6989586621679047130"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-137"></a><span>        </span><a name="local-6989586621679047132"><a href="#local-6989586621679047132"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peekElemOff</span><span> </span><a href="#local-6989586621679047130"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-138"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a href="#local-6989586621679047131"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679047132"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679047133"><a href="#local-6989586621679047133"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-var">COORD</span></a><span> </span><a name="local-6989586621679047134"><a href="#local-6989586621679047134"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679047135"><a href="#local-6989586621679047135"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-140"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679047136"><a href="#local-6989586621679047136"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047133"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span>
</span><a name="line-141"></a><span>        </span><span class="hs-identifier hs-var">pokeElemOff</span><span> </span><a href="#local-6989586621679047136"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679047134"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-142"></a><span>        </span><span class="hs-identifier hs-var">pokeElemOff</span><span> </span><a href="#local-6989586621679047136"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679047135"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-keyword">data</span><span> </span><a name="SMALL_RECT"><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier">SMALL_RECT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SMALL_RECT"><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier">SMALL_RECT</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-146"></a><span>        </span><a name="rect_top_left"><a href="System.Console.ANSI.Windows.Foreign.html#rect_top_left"><span class="hs-identifier">rect_top_left</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span class="hs-special">,</span><span>
</span><a name="line-147"></a><span>        </span><a name="rect_bottom_right"><a href="System.Console.ANSI.Windows.Foreign.html#rect_bottom_right"><span class="hs-identifier">rect_bottom_right</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-identifier">rect_top</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rect_left</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rect_bottom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rect_right</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span>
</span><a name="line-151"></a><a name="rect_top"><a href="System.Console.ANSI.Windows.Foreign.html#rect_top"><span class="hs-identifier">rect_top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coord_y</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">rect_top_left</span><span>
</span><a name="line-152"></a><a name="rect_left"><a href="System.Console.ANSI.Windows.Foreign.html#rect_left"><span class="hs-identifier">rect_left</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coord_x</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">rect_top_left</span><span>
</span><a name="line-153"></a><a name="rect_bottom"><a href="System.Console.ANSI.Windows.Foreign.html#rect_bottom"><span class="hs-identifier">rect_bottom</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coord_y</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">rect_bottom_right</span><span>
</span><a name="line-154"></a><a name="rect_right"><a href="System.Console.ANSI.Windows.Foreign.html#rect_right"><span class="hs-identifier">rect_right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coord_x</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">rect_bottom_right</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">rect_width</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rect_height</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">SHORT</span><span>
</span><a name="line-157"></a><a name="rect_width"><a href="System.Console.ANSI.Windows.Foreign.html#rect_width"><span class="hs-identifier">rect_width</span></a></a><span> </span><a name="local-6989586621679047152"><a href="#local-6989586621679047152"><span class="hs-identifier">rect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_right"><span class="hs-identifier hs-var">rect_right</span></a><span> </span><a href="#local-6989586621679047152"><span class="hs-identifier hs-var">rect</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_left"><span class="hs-identifier hs-var">rect_left</span></a><span> </span><a href="#local-6989586621679047152"><span class="hs-identifier hs-var">rect</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-158"></a><a name="rect_height"><a href="System.Console.ANSI.Windows.Foreign.html#rect_height"><span class="hs-identifier">rect_height</span></a></a><span> </span><a name="local-6989586621679047153"><a href="#local-6989586621679047153"><span class="hs-identifier">rect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_bottom"><span class="hs-identifier hs-var">rect_bottom</span></a><span> </span><a href="#local-6989586621679047153"><span class="hs-identifier hs-var">rect</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#rect_top"><span class="hs-identifier hs-var">rect_top</span></a><span> </span><a href="#local-6989586621679047153"><span class="hs-identifier hs-var">rect</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>    </span><a name="local-8214565720323793009"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-var">SMALL_RECT</span></a><span> </span><a name="local-6989586621679047124"><a href="#local-6989586621679047124"><span class="hs-identifier">tl</span></a></a><span> </span><a name="local-6989586621679047125"><a href="#local-6989586621679047125"><span class="hs-identifier">br</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679047124"><span class="hs-identifier hs-var">tl</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679047125"><span class="hs-identifier hs-var">br</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-var">SMALL_RECT</span></a><span> </span><a name="local-6989586621679047113"><a href="#local-6989586621679047113"><span class="hs-identifier">tl</span></a></a><span> </span><a name="local-6989586621679047114"><a href="#local-6989586621679047114"><span class="hs-identifier">br</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047113"><span class="hs-identifier hs-var">tl</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047114"><span class="hs-identifier hs-var">br</span></a><span>
</span><a name="line-165"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-var">SMALL_RECT</span></a><span> </span><a name="local-6989586621679047115"><a href="#local-6989586621679047115"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alignment</span><span> </span><a href="#local-6989586621679047115"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-166"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679047116"><a href="#local-6989586621679047116"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-167"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679047117"><a href="#local-6989586621679047117"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047116"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span>
</span><a name="line-168"></a><span>        </span><a name="local-6989586621679047118"><a href="#local-6989586621679047118"><span class="hs-identifier">tl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peekElemOff</span><span> </span><a href="#local-6989586621679047117"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-169"></a><span>        </span><a name="local-6989586621679047119"><a href="#local-6989586621679047119"><span class="hs-identifier">br</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peekElemOff</span><span> </span><a href="#local-6989586621679047117"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-170"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-var">SMALL_RECT</span></a><span> </span><a href="#local-6989586621679047118"><span class="hs-identifier hs-var">tl</span></a><span> </span><a href="#local-6989586621679047119"><span class="hs-identifier hs-var">br</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679047120"><a href="#local-6989586621679047120"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-var">SMALL_RECT</span></a><span> </span><a name="local-6989586621679047121"><a href="#local-6989586621679047121"><span class="hs-identifier">tl</span></a></a><span> </span><a name="local-6989586621679047122"><a href="#local-6989586621679047122"><span class="hs-identifier">br</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-172"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679047123"><a href="#local-6989586621679047123"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047120"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span>
</span><a name="line-173"></a><span>        </span><span class="hs-identifier hs-var">pokeElemOff</span><span> </span><a href="#local-6989586621679047123"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679047121"><span class="hs-identifier hs-var">tl</span></a><span>
</span><a name="line-174"></a><span>        </span><span class="hs-identifier hs-var">pokeElemOff</span><span> </span><a href="#local-6989586621679047123"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679047122"><span class="hs-identifier hs-var">br</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-keyword">data</span><span> </span><a name="CONSOLE_CURSOR_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier">CONSOLE_CURSOR_INFO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CONSOLE_CURSOR_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier">CONSOLE_CURSOR_INFO</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-178"></a><span>        </span><a name="cci_cursor_size"><a href="System.Console.ANSI.Windows.Foreign.html#cci_cursor_size"><span class="hs-identifier">cci_cursor_size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>        </span><a name="cci_cursor_visible"><a href="System.Console.ANSI.Windows.Foreign.html#cci_cursor_visible"><span class="hs-identifier">cci_cursor_visible</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">BOOL</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-181"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">CONSOLE_CURSOR_INFO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-184"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-var">CONSOLE_CURSOR_INFO</span></a><span> </span><a name="local-6989586621679047102"><a href="#local-6989586621679047102"><span class="hs-identifier">size</span></a></a><span> </span><a name="local-6989586621679047103"><a href="#local-6989586621679047103"><span class="hs-identifier">visible</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047102"><span class="hs-identifier hs-var">size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047103"><span class="hs-identifier hs-var">visible</span></a><span>
</span><a name="line-185"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-var">CONSOLE_CURSOR_INFO</span></a><span> </span><a name="local-6989586621679047104"><a href="#local-6989586621679047104"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alignment</span><span> </span><a href="#local-6989586621679047104"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-186"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679047105"><a href="#local-6989586621679047105"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-187"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047106"><a href="#local-6989586621679047106"><span class="hs-identifier">size</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047107"><a href="#local-6989586621679047107"><span class="hs-identifier">ptr'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047105"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>        </span><a name="local-6989586621679047108"><a href="#local-6989586621679047108"><span class="hs-identifier">visible</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047107"><span class="hs-identifier hs-var">ptr'</span></a><span>
</span><a name="line-189"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-var">CONSOLE_CURSOR_INFO</span></a><span> </span><a href="#local-6989586621679047106"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679047108"><span class="hs-identifier hs-var">visible</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679047109"><a href="#local-6989586621679047109"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-var">CONSOLE_CURSOR_INFO</span></a><span> </span><a name="local-6989586621679047110"><a href="#local-6989586621679047110"><span class="hs-identifier">size</span></a></a><span> </span><a name="local-6989586621679047111"><a href="#local-6989586621679047111"><span class="hs-identifier">visible</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-191"></a><span>        </span><a name="local-6989586621679047112"><a href="#local-6989586621679047112"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047109"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047110"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-192"></a><span>        </span><span class="hs-identifier hs-var">poke</span><span> </span><a href="#local-6989586621679047112"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><a href="#local-6989586621679047111"><span class="hs-identifier hs-var">visible</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-keyword">data</span><span> </span><a name="CONSOLE_SCREEN_BUFFER_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier">CONSOLE_SCREEN_BUFFER_INFO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CONSOLE_SCREEN_BUFFER_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier">CONSOLE_SCREEN_BUFFER_INFO</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-196"></a><span>        </span><a name="csbi_size"><a href="System.Console.ANSI.Windows.Foreign.html#csbi_size"><span class="hs-identifier">csbi_size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span class="hs-special">,</span><span>
</span><a name="line-197"></a><span>        </span><a name="csbi_cursor_position"><a href="System.Console.ANSI.Windows.Foreign.html#csbi_cursor_position"><span class="hs-identifier">csbi_cursor_position</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span class="hs-special">,</span><span>
</span><a name="line-198"></a><span>        </span><a name="csbi_attributes"><a href="System.Console.ANSI.Windows.Foreign.html#csbi_attributes"><span class="hs-identifier">csbi_attributes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span>
</span><a name="line-199"></a><span>        </span><a name="csbi_window"><a href="System.Console.ANSI.Windows.Foreign.html#csbi_window"><span class="hs-identifier">csbi_window</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span class="hs-special">,</span><span>
</span><a name="line-200"></a><span>        </span><a name="csbi_maximum_window_size"><a href="System.Console.ANSI.Windows.Foreign.html#csbi_maximum_window_size"><span class="hs-identifier">csbi_maximum_window_size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span>
</span><a name="line-201"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-type">CONSOLE_SCREEN_BUFFER_INFO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-205"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-var">CONSOLE_SCREEN_BUFFER_INFO</span></a><span> </span><a name="local-6989586621679047076"><a href="#local-6989586621679047076"><span class="hs-identifier">size</span></a></a><span> </span><a name="local-6989586621679047077"><a href="#local-6989586621679047077"><span class="hs-identifier">cursor_position</span></a></a><span> </span><a name="local-6989586621679047078"><a href="#local-6989586621679047078"><span class="hs-identifier">attributes</span></a></a><span> </span><a name="local-6989586621679047079"><a href="#local-6989586621679047079"><span class="hs-identifier">window</span></a></a><span> </span><a name="local-6989586621679047080"><a href="#local-6989586621679047080"><span class="hs-identifier">maximum_window_size</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047076"><span class="hs-identifier hs-var">size</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047077"><span class="hs-identifier hs-var">cursor_position</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047078"><span class="hs-identifier hs-var">attributes</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047079"><span class="hs-identifier hs-var">window</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679047080"><span class="hs-identifier hs-var">maximum_window_size</span></a><span>
</span><a name="line-207"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-var">CONSOLE_SCREEN_BUFFER_INFO</span></a><span> </span><a name="local-6989586621679047081"><a href="#local-6989586621679047081"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alignment</span><span> </span><a href="#local-6989586621679047081"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-208"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679047082"><a href="#local-6989586621679047082"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-209"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047083"><a href="#local-6989586621679047083"><span class="hs-identifier">size</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047084"><a href="#local-6989586621679047084"><span class="hs-identifier">ptr1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047082"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047085"><a href="#local-6989586621679047085"><span class="hs-identifier">cursor_position</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047086"><a href="#local-6989586621679047086"><span class="hs-identifier">ptr2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><a href="#local-6989586621679047084"><span class="hs-identifier hs-var">ptr1</span></a><span>
</span><a name="line-211"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047087"><a href="#local-6989586621679047087"><span class="hs-identifier">attributes</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047088"><a href="#local-6989586621679047088"><span class="hs-identifier">ptr3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><a href="#local-6989586621679047086"><span class="hs-identifier hs-var">ptr2</span></a><span>
</span><a name="line-212"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047089"><a href="#local-6989586621679047089"><span class="hs-identifier">window</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047090"><a href="#local-6989586621679047090"><span class="hs-identifier">ptr4</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><a href="#local-6989586621679047088"><span class="hs-identifier hs-var">ptr3</span></a><span>
</span><a name="line-213"></a><span>        </span><a name="local-6989586621679047091"><a href="#local-6989586621679047091"><span class="hs-identifier">maximum_window_size</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047090"><span class="hs-identifier hs-var">ptr4</span></a><span>
</span><a name="line-214"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-var">CONSOLE_SCREEN_BUFFER_INFO</span></a><span> </span><a href="#local-6989586621679047083"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">cursor_position</span></a><span> </span><a href="#local-6989586621679047087"><span class="hs-identifier hs-var">attributes</span></a><span> </span><a href="#local-6989586621679047089"><span class="hs-identifier hs-var">window</span></a><span> </span><a href="#local-6989586621679047091"><span class="hs-identifier hs-var">maximum_window_size</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679047092"><a href="#local-6989586621679047092"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-var">CONSOLE_SCREEN_BUFFER_INFO</span></a><span> </span><a name="local-6989586621679047093"><a href="#local-6989586621679047093"><span class="hs-identifier">size</span></a></a><span> </span><a name="local-6989586621679047094"><a href="#local-6989586621679047094"><span class="hs-identifier">cursor_position</span></a></a><span> </span><a name="local-6989586621679047095"><a href="#local-6989586621679047095"><span class="hs-identifier">attributes</span></a></a><span> </span><a name="local-6989586621679047096"><a href="#local-6989586621679047096"><span class="hs-identifier">window</span></a></a><span> </span><a name="local-6989586621679047097"><a href="#local-6989586621679047097"><span class="hs-identifier">maximum_window_size</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-216"></a><span>        </span><a name="local-6989586621679047098"><a href="#local-6989586621679047098"><span class="hs-identifier">ptr1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047092"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047093"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-217"></a><span>        </span><a name="local-6989586621679047099"><a href="#local-6989586621679047099"><span class="hs-identifier">ptr2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><a href="#local-6989586621679047098"><span class="hs-identifier hs-var">ptr1</span></a><span> </span><a href="#local-6989586621679047094"><span class="hs-identifier hs-var">cursor_position</span></a><span>
</span><a name="line-218"></a><span>        </span><a name="local-6989586621679047100"><a href="#local-6989586621679047100"><span class="hs-identifier">ptr3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><a href="#local-6989586621679047099"><span class="hs-identifier hs-var">ptr2</span></a><span> </span><a href="#local-6989586621679047095"><span class="hs-identifier hs-var">attributes</span></a><span>
</span><a name="line-219"></a><span>        </span><a name="local-6989586621679047101"><a href="#local-6989586621679047101"><span class="hs-identifier">ptr4</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><a href="#local-6989586621679047100"><span class="hs-identifier hs-var">ptr3</span></a><span> </span><a href="#local-6989586621679047096"><span class="hs-identifier hs-var">window</span></a><span>
</span><a name="line-220"></a><span>        </span><span class="hs-identifier hs-var">poke</span><span> </span><a href="#local-6989586621679047101"><span class="hs-identifier hs-var">ptr4</span></a><span> </span><a href="#local-6989586621679047097"><span class="hs-identifier hs-var">maximum_window_size</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-keyword">data</span><span> </span><a name="CHAR_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier">CHAR_INFO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CHAR_INFO"><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier">CHAR_INFO</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-224"></a><span>        </span><a name="ci_char"><a href="System.Console.ANSI.Windows.Foreign.html#ci_char"><span class="hs-identifier">ci_char</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WCHAR"><span class="hs-identifier hs-type">WCHAR</span></a><span class="hs-special">,</span><span>
</span><a name="line-225"></a><span>        </span><a name="ci_attributes"><a href="System.Console.ANSI.Windows.Foreign.html#ci_attributes"><span class="hs-identifier">ci_attributes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span>
</span><a name="line-226"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-type">CHAR_INFO</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-230"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-var">CHAR_INFO</span></a><span> </span><a name="local-6989586621679046935"><a href="#local-6989586621679046935"><span class="hs-identifier">char</span></a></a><span> </span><a name="local-6989586621679046936"><a href="#local-6989586621679046936"><span class="hs-identifier">attributes</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679046935"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">sizeOf</span><span> </span><a href="#local-6989586621679046936"><span class="hs-identifier hs-var">attributes</span></a><span>
</span><a name="line-231"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-var">CHAR_INFO</span></a><span> </span><a name="local-6989586621679046937"><a href="#local-6989586621679046937"><span class="hs-identifier">char</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alignment</span><span> </span><a href="#local-6989586621679046937"><span class="hs-identifier hs-var">char</span></a><span>
</span><a name="line-232"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046938"><a href="#local-6989586621679046938"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-233"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679047069"><a href="#local-6989586621679047069"><span class="hs-identifier">char</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047070"><a href="#local-6989586621679047070"><span class="hs-identifier">ptr'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#peekAndOffset"><span class="hs-identifier hs-var">peekAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679046938"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>        </span><a name="local-6989586621679047071"><a href="#local-6989586621679047071"><span class="hs-identifier">attributes</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047070"><span class="hs-identifier hs-var">ptr'</span></a><span>
</span><a name="line-235"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-var">CHAR_INFO</span></a><span> </span><a href="#local-6989586621679047069"><span class="hs-identifier hs-var">char</span></a><span> </span><a href="#local-6989586621679047071"><span class="hs-identifier hs-var">attributes</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679047072"><a href="#local-6989586621679047072"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-var">CHAR_INFO</span></a><span> </span><a name="local-6989586621679047073"><a href="#local-6989586621679047073"><span class="hs-identifier">char</span></a></a><span> </span><a name="local-6989586621679047074"><a href="#local-6989586621679047074"><span class="hs-identifier">attributes</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-237"></a><span>        </span><a name="local-6989586621679047075"><a href="#local-6989586621679047075"><span class="hs-identifier">ptr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#pokeAndOffset"><span class="hs-identifier hs-var">pokeAndOffset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679047072"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047073"><span class="hs-identifier hs-var">char</span></a><span>
</span><a name="line-238"></a><span>        </span><span class="hs-identifier hs-var">poke</span><span> </span><a href="#local-6989586621679047075"><span class="hs-identifier hs-var">ptr'</span></a><span> </span><a href="#local-6989586621679047074"><span class="hs-identifier hs-var">attributes</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-identifier">eNABLE_VIRTUAL_TERMINAL_INPUT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eNABLE_VIRTUAL_TERMINAL_PROCESSING</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-242"></a><span class="hs-identifier">sTD_INPUT_HANDLE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sTD_OUTPUT_HANDLE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sTD_ERROR_HANDLE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-243"></a><a name="eNABLE_VIRTUAL_TERMINAL_INPUT"><a href="System.Console.ANSI.Windows.Foreign.html#eNABLE_VIRTUAL_TERMINAL_INPUT"><span class="hs-identifier">eNABLE_VIRTUAL_TERMINAL_INPUT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">512</span><span>
</span><a name="line-244"></a><a name="eNABLE_VIRTUAL_TERMINAL_PROCESSING"><a href="System.Console.ANSI.Windows.Foreign.html#eNABLE_VIRTUAL_TERMINAL_PROCESSING"><span class="hs-identifier">eNABLE_VIRTUAL_TERMINAL_PROCESSING</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-245"></a><a name="sTD_INPUT_HANDLE"><a href="System.Console.ANSI.Windows.Foreign.html#sTD_INPUT_HANDLE"><span class="hs-identifier">sTD_INPUT_HANDLE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">10</span><span>
</span><a name="line-246"></a><a name="sTD_OUTPUT_HANDLE"><a href="System.Console.ANSI.Windows.Foreign.html#sTD_OUTPUT_HANDLE"><span class="hs-identifier">sTD_OUTPUT_HANDLE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">11</span><span>
</span><a name="line-247"></a><a name="sTD_ERROR_HANDLE"><a href="System.Console.ANSI.Windows.Foreign.html#sTD_ERROR_HANDLE"><span class="hs-identifier">sTD_ERROR_HANDLE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">12</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-identifier">fOREGROUND_BLUE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fOREGROUND_GREEN</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fOREGROUND_RED</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fOREGROUND_INTENSITY</span><span class="hs-special">,</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-identifier">bACKGROUND_BLUE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bACKGROUND_GREEN</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bACKGROUND_RED</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bACKGROUND_INTENSITY</span><span class="hs-special">,</span><span>
</span><a name="line-251"></a><span>  </span><span class="hs-identifier">cOMMON_LVB_REVERSE_VIDEO</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">cOMMON_LVB_UNDERSCORE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span>
</span><a name="line-252"></a><a name="fOREGROUND_BLUE"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_BLUE"><span class="hs-identifier">fOREGROUND_BLUE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x1</span><span>
</span><a name="line-253"></a><a name="fOREGROUND_GREEN"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_GREEN"><span class="hs-identifier">fOREGROUND_GREEN</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x2</span><span>
</span><a name="line-254"></a><a name="fOREGROUND_RED"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_RED"><span class="hs-identifier">fOREGROUND_RED</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x4</span><span>
</span><a name="line-255"></a><a name="fOREGROUND_INTENSITY"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_INTENSITY"><span class="hs-identifier">fOREGROUND_INTENSITY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x8</span><span>
</span><a name="line-256"></a><a name="bACKGROUND_BLUE"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_BLUE"><span class="hs-identifier">bACKGROUND_BLUE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x10</span><span>
</span><a name="line-257"></a><a name="bACKGROUND_GREEN"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_GREEN"><span class="hs-identifier">bACKGROUND_GREEN</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x20</span><span>
</span><a name="line-258"></a><a name="bACKGROUND_RED"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_RED"><span class="hs-identifier">bACKGROUND_RED</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x40</span><span>
</span><a name="line-259"></a><a name="bACKGROUND_INTENSITY"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_INTENSITY"><span class="hs-identifier">bACKGROUND_INTENSITY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x80</span><span>
</span><a name="line-260"></a><a name="cOMMON_LVB_REVERSE_VIDEO"><a href="System.Console.ANSI.Windows.Foreign.html#cOMMON_LVB_REVERSE_VIDEO"><span class="hs-identifier">cOMMON_LVB_REVERSE_VIDEO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x4000</span><span>
</span><a name="line-261"></a><a name="cOMMON_LVB_UNDERSCORE"><a href="System.Console.ANSI.Windows.Foreign.html#cOMMON_LVB_UNDERSCORE"><span class="hs-identifier">cOMMON_LVB_UNDERSCORE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x8000</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-identifier">fOREGROUND_WHITE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bACKGROUND_WHITE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fOREGROUND_INTENSE_WHITE</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bACKGROUND_INTENSE_WHITE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span>
</span><a name="line-264"></a><a name="fOREGROUND_WHITE"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_WHITE"><span class="hs-identifier">fOREGROUND_WHITE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_RED"><span class="hs-identifier hs-var">fOREGROUND_RED</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_GREEN"><span class="hs-identifier hs-var">fOREGROUND_GREEN</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_BLUE"><span class="hs-identifier hs-var">fOREGROUND_BLUE</span></a><span>
</span><a name="line-265"></a><a name="bACKGROUND_WHITE"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_WHITE"><span class="hs-identifier">bACKGROUND_WHITE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_RED"><span class="hs-identifier hs-var">bACKGROUND_RED</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_GREEN"><span class="hs-identifier hs-var">bACKGROUND_GREEN</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_BLUE"><span class="hs-identifier hs-var">bACKGROUND_BLUE</span></a><span>
</span><a name="line-266"></a><a name="fOREGROUND_INTENSE_WHITE"><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_INTENSE_WHITE"><span class="hs-identifier">fOREGROUND_INTENSE_WHITE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_WHITE"><span class="hs-identifier hs-var">fOREGROUND_WHITE</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOREGROUND_INTENSITY"><span class="hs-identifier hs-var">fOREGROUND_INTENSITY</span></a><span>
</span><a name="line-267"></a><a name="bACKGROUND_INTENSE_WHITE"><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_INTENSE_WHITE"><span class="hs-identifier">bACKGROUND_INTENSE_WHITE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_WHITE"><span class="hs-identifier hs-var">bACKGROUND_WHITE</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#bACKGROUND_INTENSITY"><span class="hs-identifier hs-var">bACKGROUND_INTENSITY</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">kEY_EVENT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mOUSE_EVENT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">wINDOW_BUFFER_SIZE_EVENT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mENU_EVENT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fOCUS_EVENT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span>
</span><a name="line-270"></a><a name="kEY_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#kEY_EVENT"><span class="hs-identifier">kEY_EVENT</span></a></a><span>                </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">1</span><span>
</span><a name="line-271"></a><a name="mOUSE_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#mOUSE_EVENT"><span class="hs-identifier">mOUSE_EVENT</span></a></a><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">2</span><span>
</span><a name="line-272"></a><a name="wINDOW_BUFFER_SIZE_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#wINDOW_BUFFER_SIZE_EVENT"><span class="hs-identifier">wINDOW_BUFFER_SIZE_EVENT</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">4</span><span>
</span><a name="line-273"></a><a name="mENU_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#mENU_EVENT"><span class="hs-identifier">mENU_EVENT</span></a></a><span>               </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">8</span><span>
</span><a name="line-274"></a><a name="fOCUS_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#fOCUS_EVENT"><span class="hs-identifier">fOCUS_EVENT</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h GetStdHandle&quot;</span><span> </span><span class="hs-identifier">getStdHandle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">HANDLE</span><span>
</span><a name="line-277"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h GetConsoleScreenBufferInfo&quot;</span><span> </span><span class="hs-identifier">cGetConsoleScreenBufferInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">CONSOLE_SCREEN_BUFFER_INFO</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-278"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h GetConsoleCursorInfo&quot;</span><span> </span><span class="hs-identifier">cGetConsoleCursorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">CONSOLE_CURSOR_INFO</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-279"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h GetConsoleMode&quot;</span><span> </span><span class="hs-identifier">cGetConsoleMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h SetConsoleTextAttribute&quot;</span><span> </span><span class="hs-identifier">cSetConsoleTextAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">WORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-282"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h SetConsoleCursorPosition&quot;</span><span> </span><span class="hs-identifier">cSetConsoleCursorPosition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UNPACKED_COORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-283"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h SetConsoleCursorInfo&quot;</span><span> </span><span class="hs-identifier">cSetConsoleCursorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">CONSOLE_CURSOR_INFO</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-284"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h SetConsoleTitleW&quot;</span><span> </span><span class="hs-identifier">cSetConsoleTitle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">LPCTSTR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-285"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h SetConsoleMode&quot;</span><span> </span><span class="hs-identifier">cSetConsoleMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h FillConsoleOutputAttribute&quot;</span><span> </span><span class="hs-identifier">cFillConsoleOutputAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UNPACKED_COORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-288"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h FillConsoleOutputCharacterW&quot;</span><span> </span><span class="hs-identifier">cFillConsoleOutputCharacter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">TCHAR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UNPACKED_COORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-289"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h ScrollConsoleScreenBufferW&quot;</span><span> </span><span class="hs-identifier">cScrollConsoleScreenBuffer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">SMALL_RECT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">SMALL_RECT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">UNPACKED_COORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">CHAR_INFO</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h WriteConsoleInputW&quot;</span><span> </span><span class="hs-identifier">cWriteConsoleInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">INPUT_RECORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LPDWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-292"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h GetNumberOfConsoleInputEvents&quot;</span><span> </span><span class="hs-identifier">cGetNumberOfConsoleInputEvents</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-293"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;windows.h ReadConsoleInputW&quot;</span><span> </span><span class="hs-identifier">cReadConsoleInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><span class="hs-identifier">INPUT_RECORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">LPDWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">BOOL</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-keyword">data</span><span> </span><a name="ConsoleException"><a href="System.Console.ANSI.Windows.Foreign.html#ConsoleException"><span class="hs-identifier">ConsoleException</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ConsoleException"><a href="System.Console.ANSI.Windows.Foreign.html#ConsoleException"><span class="hs-identifier">ConsoleException</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">ErrCode</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Exception</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#ConsoleException"><span class="hs-identifier hs-type">ConsoleException</span></a><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-identifier">throwIfFalse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-300"></a><a name="throwIfFalse"><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier">throwIfFalse</span></a></a><span> </span><a name="local-6989586621679047154"><a href="#local-6989586621679047154"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-301"></a><span>  </span><a name="local-6989586621679047155"><a href="#local-6989586621679047155"><span class="hs-identifier">succeeded</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679047154"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679047155"><span class="hs-identifier hs-var">succeeded</span></a><span>
</span><a name="line-303"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">getLastError</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-identifier hs-var">throw</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#ConsoleException"><span class="hs-identifier hs-var">ConsoleException</span></a><span> </span><span class="hs-comment">-- TODO: Check if last error is zero for some instructable reason (?)</span><span>
</span><a name="line-304"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">getConsoleScreenBufferInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_SCREEN_BUFFER_INFO"><span class="hs-identifier hs-type">CONSOLE_SCREEN_BUFFER_INFO</span></a><span>
</span><a name="line-307"></a><a name="getConsoleScreenBufferInfo"><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleScreenBufferInfo"><span class="hs-identifier">getConsoleScreenBufferInfo</span></a></a><span> </span><a name="local-6989586621679047156"><a href="#local-6989586621679047156"><span class="hs-identifier">handle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047225"><a href="#local-6989586621679047225"><span class="hs-identifier">ptr_console_screen_buffer_info</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-308"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cGetConsoleScreenBufferInfo"><span class="hs-identifier hs-var">cGetConsoleScreenBufferInfo</span></a><span> </span><a href="#local-6989586621679047156"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047225"><span class="hs-identifier hs-var">ptr_console_screen_buffer_info</span></a><span>
</span><a name="line-309"></a><span>    </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047225"><span class="hs-identifier hs-var">ptr_console_screen_buffer_info</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-identifier">getConsoleCursorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">CONSOLE_CURSOR_INFO</span></a><span>
</span><a name="line-313"></a><a name="getConsoleCursorInfo"><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleCursorInfo"><span class="hs-identifier">getConsoleCursorInfo</span></a></a><span> </span><a name="local-6989586621679047226"><a href="#local-6989586621679047226"><span class="hs-identifier">handle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047227"><a href="#local-6989586621679047227"><span class="hs-identifier">ptr_console_cursor_info</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-314"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cGetConsoleCursorInfo"><span class="hs-identifier hs-var">cGetConsoleCursorInfo</span></a><span> </span><a href="#local-6989586621679047226"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047227"><span class="hs-identifier hs-var">ptr_console_cursor_info</span></a><span>
</span><a name="line-315"></a><span>    </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047227"><span class="hs-identifier hs-var">ptr_console_cursor_info</span></a><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-identifier">getConsoleMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-318"></a><a name="getConsoleMode"><a href="System.Console.ANSI.Windows.Foreign.html#getConsoleMode"><span class="hs-identifier">getConsoleMode</span></a></a><span> </span><a name="local-6989586621679047228"><a href="#local-6989586621679047228"><span class="hs-identifier">handle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047229"><a href="#local-6989586621679047229"><span class="hs-identifier">ptr_mode</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-319"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cGetConsoleMode"><span class="hs-identifier hs-var">cGetConsoleMode</span></a><span> </span><a href="#local-6989586621679047228"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047229"><span class="hs-identifier hs-var">ptr_mode</span></a><span>
</span><a name="line-320"></a><span>    </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047229"><span class="hs-identifier hs-var">ptr_mode</span></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-identifier">setConsoleTextAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><a name="setConsoleTextAttribute"><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleTextAttribute"><span class="hs-identifier">setConsoleTextAttribute</span></a></a><span> </span><a name="local-6989586621679047230"><a href="#local-6989586621679047230"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047231"><a href="#local-6989586621679047231"><span class="hs-identifier">attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cSetConsoleTextAttribute"><span class="hs-identifier hs-var">cSetConsoleTextAttribute</span></a><span> </span><a href="#local-6989586621679047230"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047231"><span class="hs-identifier hs-var">attributes</span></a><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-identifier">setConsoleCursorPosition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><a name="setConsoleCursorPosition"><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleCursorPosition"><span class="hs-identifier">setConsoleCursorPosition</span></a></a><span> </span><a name="local-6989586621679047232"><a href="#local-6989586621679047232"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047233"><a href="#local-6989586621679047233"><span class="hs-identifier">cursor_position</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cSetConsoleCursorPosition"><span class="hs-identifier hs-var">cSetConsoleCursorPosition</span></a><span> </span><a href="#local-6989586621679047232"><span class="hs-identifier hs-var">handle</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#unpackCOORD"><span class="hs-identifier hs-var">unpackCOORD</span></a><span> </span><a href="#local-6989586621679047233"><span class="hs-identifier hs-var">cursor_position</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-identifier">setConsoleCursorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CONSOLE_CURSOR_INFO"><span class="hs-identifier hs-type">CONSOLE_CURSOR_INFO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><a name="setConsoleCursorInfo"><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleCursorInfo"><span class="hs-identifier">setConsoleCursorInfo</span></a></a><span> </span><a name="local-6989586621679047234"><a href="#local-6989586621679047234"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047235"><a href="#local-6989586621679047235"><span class="hs-identifier">console_cursor_info</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">with</span><span> </span><a href="#local-6989586621679047235"><span class="hs-identifier hs-var">console_cursor_info</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047279"><a href="#local-6989586621679047279"><span class="hs-identifier">ptr_console_cursor_info</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-330"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cSetConsoleCursorInfo"><span class="hs-identifier hs-var">cSetConsoleCursorInfo</span></a><span> </span><a href="#local-6989586621679047234"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047279"><span class="hs-identifier hs-var">ptr_console_cursor_info</span></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-identifier">setConsoleTitle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">LPCTSTR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><a name="setConsoleTitle"><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleTitle"><span class="hs-identifier">setConsoleTitle</span></a></a><span> </span><a name="local-6989586621679047280"><a href="#local-6989586621679047280"><span class="hs-identifier">title</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cSetConsoleTitle"><span class="hs-identifier hs-var">cSetConsoleTitle</span></a><span> </span><a href="#local-6989586621679047280"><span class="hs-identifier hs-var">title</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-identifier">setConsoleMode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-336"></a><a name="setConsoleMode"><a href="System.Console.ANSI.Windows.Foreign.html#setConsoleMode"><span class="hs-identifier">setConsoleMode</span></a></a><span> </span><a name="local-6989586621679047281"><a href="#local-6989586621679047281"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047282"><a href="#local-6989586621679047282"><span class="hs-identifier">attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cSetConsoleMode"><span class="hs-identifier hs-var">cSetConsoleMode</span></a><span> </span><a href="#local-6989586621679047281"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047282"><span class="hs-identifier hs-var">attributes</span></a><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-identifier">fillConsoleOutputAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-340"></a><a name="fillConsoleOutputAttribute"><a href="System.Console.ANSI.Windows.Foreign.html#fillConsoleOutputAttribute"><span class="hs-identifier">fillConsoleOutputAttribute</span></a></a><span> </span><a name="local-6989586621679047283"><a href="#local-6989586621679047283"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047284"><a href="#local-6989586621679047284"><span class="hs-identifier">attribute</span></a></a><span> </span><a name="local-6989586621679047285"><a href="#local-6989586621679047285"><span class="hs-identifier">fill_length</span></a></a><span> </span><a name="local-6989586621679047286"><a href="#local-6989586621679047286"><span class="hs-identifier">write_origin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047287"><a href="#local-6989586621679047287"><span class="hs-identifier">ptr_chars_written</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-341"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cFillConsoleOutputAttribute"><span class="hs-identifier hs-var">cFillConsoleOutputAttribute</span></a><span> </span><a href="#local-6989586621679047283"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047284"><span class="hs-identifier hs-var">attribute</span></a><span> </span><a href="#local-6989586621679047285"><span class="hs-identifier hs-var">fill_length</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#unpackCOORD"><span class="hs-identifier hs-var">unpackCOORD</span></a><span> </span><a href="#local-6989586621679047286"><span class="hs-identifier hs-var">write_origin</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047287"><span class="hs-identifier hs-var">ptr_chars_written</span></a><span>
</span><a name="line-342"></a><span>    </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047287"><span class="hs-identifier hs-var">ptr_chars_written</span></a><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-identifier">fillConsoleOutputCharacter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TCHAR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-345"></a><a name="fillConsoleOutputCharacter"><a href="System.Console.ANSI.Windows.Foreign.html#fillConsoleOutputCharacter"><span class="hs-identifier">fillConsoleOutputCharacter</span></a></a><span> </span><a name="local-6989586621679047288"><a href="#local-6989586621679047288"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047289"><a href="#local-6989586621679047289"><span class="hs-identifier">char</span></a></a><span> </span><a name="local-6989586621679047290"><a href="#local-6989586621679047290"><span class="hs-identifier">fill_length</span></a></a><span> </span><a name="local-6989586621679047291"><a href="#local-6989586621679047291"><span class="hs-identifier">write_origin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047292"><a href="#local-6989586621679047292"><span class="hs-identifier">ptr_chars_written</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-346"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cFillConsoleOutputCharacter"><span class="hs-identifier hs-var">cFillConsoleOutputCharacter</span></a><span> </span><a href="#local-6989586621679047288"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047289"><span class="hs-identifier hs-var">char</span></a><span> </span><a href="#local-6989586621679047290"><span class="hs-identifier hs-var">fill_length</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#unpackCOORD"><span class="hs-identifier hs-var">unpackCOORD</span></a><span> </span><a href="#local-6989586621679047291"><span class="hs-identifier hs-var">write_origin</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047292"><span class="hs-identifier hs-var">ptr_chars_written</span></a><span>
</span><a name="line-347"></a><span>    </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047292"><span class="hs-identifier hs-var">ptr_chars_written</span></a><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">scrollConsoleScreenBuffer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#SMALL_RECT"><span class="hs-identifier hs-type">SMALL_RECT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#CHAR_INFO"><span class="hs-identifier hs-type">CHAR_INFO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><a name="scrollConsoleScreenBuffer"><a href="System.Console.ANSI.Windows.Foreign.html#scrollConsoleScreenBuffer"><span class="hs-identifier">scrollConsoleScreenBuffer</span></a></a><span> </span><a name="local-6989586621679047293"><a href="#local-6989586621679047293"><span class="hs-identifier">handle</span></a></a><span> </span><a name="local-6989586621679047294"><a href="#local-6989586621679047294"><span class="hs-identifier">scroll_rectangle</span></a></a><span> </span><a name="local-6989586621679047295"><a href="#local-6989586621679047295"><span class="hs-identifier">mb_clip_rectangle</span></a></a><span> </span><a name="local-6989586621679047296"><a href="#local-6989586621679047296"><span class="hs-identifier">destination_origin</span></a></a><span> </span><a name="local-6989586621679047297"><a href="#local-6989586621679047297"><span class="hs-identifier">fill</span></a></a><span>
</span><a name="line-351"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">with</span><span> </span><a href="#local-6989586621679047294"><span class="hs-identifier hs-var">scroll_rectangle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047298"><a href="#local-6989586621679047298"><span class="hs-identifier">ptr_scroll_rectangle</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-352"></a><span>    </span><span class="hs-identifier hs-var">maybeWith</span><span> </span><span class="hs-identifier hs-var">with</span><span> </span><a href="#local-6989586621679047295"><span class="hs-identifier hs-var">mb_clip_rectangle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047299"><a href="#local-6989586621679047299"><span class="hs-identifier">ptr_clip_rectangle</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-353"></a><span>    </span><span class="hs-identifier hs-var">with</span><span> </span><a href="#local-6989586621679047297"><span class="hs-identifier hs-var">fill</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047300"><a href="#local-6989586621679047300"><span class="hs-identifier">ptr_fill</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-354"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#throwIfFalse"><span class="hs-identifier hs-var">throwIfFalse</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cScrollConsoleScreenBuffer"><span class="hs-identifier hs-var">cScrollConsoleScreenBuffer</span></a><span> </span><a href="#local-6989586621679047293"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="#local-6989586621679047298"><span class="hs-identifier hs-var">ptr_scroll_rectangle</span></a><span> </span><a href="#local-6989586621679047299"><span class="hs-identifier hs-var">ptr_clip_rectangle</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.ANSI.Windows.Foreign.html#unpackCOORD"><span class="hs-identifier hs-var">unpackCOORD</span></a><span> </span><a href="#local-6989586621679047296"><span class="hs-identifier hs-var">destination_origin</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047300"><span class="hs-identifier hs-var">ptr_fill</span></a><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-cpp">#if !MIN_VERSION_Win32(2,5,1)</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- | This bit is all highly dubious.  The problem is that we want to output ANSI to arbitrary Handles rather than forcing</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- people to use stdout.  However, the Windows ANSI emulator needs a Windows HANDLE to work it's magic, so we need to be able</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- to extract one of those from the Haskell Handle.</span><span>
</span><a name="line-361"></a><span class="hs-comment">--</span><span>
</span><a name="line-362"></a><span class="hs-comment">-- This code accomplishes this, albeit at the cost of only being compatible with GHC.</span><span>
</span><a name="line-363"></a><span class="hs-comment">-- withHandleToHANDLE was added in Win32-2.5.1.0</span><span>
</span><a name="line-364"></a><span class="hs-identifier">withHandleToHANDLE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Handle</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-365"></a><span class="hs-identifier">withHandleToHANDLE</span><span> </span><span class="hs-identifier">haskell_handle</span><span> </span><span class="hs-identifier">action</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-comment">-- Create a stable pointer to the Handle. This prevents the garbage collector</span><span>
</span><a name="line-367"></a><span>    </span><span class="hs-comment">-- getting to it while we are doing horrible manipulations with it, and hence</span><span>
</span><a name="line-368"></a><span>    </span><span class="hs-comment">-- stops it being finalized (and closed).</span><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier">withStablePtr</span><span> </span><span class="hs-identifier">haskell_handle</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">const</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-370"></a><span>        </span><span class="hs-comment">-- Grab the write handle variable from the Handle</span><span>
</span><a name="line-371"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">write_handle_mvar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">haskell_handle</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-372"></a><span>                </span><span class="hs-identifier">FileHandle</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">handle_mvar</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">handle_mvar</span><span>
</span><a name="line-373"></a><span>                </span><span class="hs-identifier">DuplexHandle</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">handle_mvar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">handle_mvar</span><span> </span><span class="hs-comment">-- This is &quot;write&quot; MVar, we could also take the &quot;read&quot; one</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span>        </span><span class="hs-comment">-- Get the FD from the algebraic data type</span><span>
</span><a name="line-376"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 612</span><span>
</span><a name="line-377"></a><span>        </span><span class="hs-identifier">fd</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">haFD</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">readMVar</span><span> </span><span class="hs-identifier">write_handle_mvar</span><span>
</span><a name="line-378"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-379"></a><span>        </span><span class="hs-comment">--readMVar write_handle_mvar &gt;&gt;= \(Handle__ { haDevice = dev }) -&gt; print (typeOf dev)</span><span>
</span><a name="line-380"></a><span>        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fd</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Handle__</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">haDevice</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">dev</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">fdFD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">dev</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">readMVar</span><span> </span><span class="hs-identifier">write_handle_mvar</span><span>
</span><a name="line-381"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span>        </span><span class="hs-comment">-- Finally, turn that (C-land) FD into a HANDLE using msvcrt</span><span>
</span><a name="line-384"></a><span>        </span><span class="hs-identifier">windows_handle</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">cget_osfhandle</span><span> </span><span class="hs-identifier">fd</span><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span>        </span><span class="hs-comment">-- Do what the user originally wanted</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-identifier">action</span><span> </span><span class="hs-identifier">windows_handle</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">-- This essential function comes from the C runtime system. It is certainly provided by msvcrt, and also seems to be provided by the mingw C library - hurrah!</span><span>
</span><a name="line-390"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 612</span><span>
</span><a name="line-391"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;_get_osfhandle&quot;</span><span> </span><span class="hs-identifier">cget_osfhandle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">HANDLE</span><span>
</span><a name="line-392"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-393"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">WINDOWS_CCONV</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;_get_osfhandle&quot;</span><span> </span><span class="hs-identifier">cget_osfhandle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IOBase</span><span class="hs-operator">.</span><span class="hs-identifier">FD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">HANDLE</span><span>
</span><a name="line-394"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-comment">-- withStablePtr was added in Win32-2.5.1.0</span><span>
</span><a name="line-397"></a><span class="hs-identifier">withStablePtr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StablePtr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-398"></a><span class="hs-identifier">withStablePtr</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bracket</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">newStablePtr</span><span> </span><span class="hs-identifier">value</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">freeStablePtr</span><span>
</span><a name="line-399"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-comment">-- The following is based on module System.Win32.Console.Extra from package</span><span>
</span><a name="line-402"></a><span class="hs-comment">-- Win32-console, cut down for the WCHAR version of writeConsoleInput.</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span class="hs-identifier">writeConsoleInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-405"></a><a name="writeConsoleInput"><a href="System.Console.ANSI.Windows.Foreign.html#writeConsoleInput"><span class="hs-identifier">writeConsoleInput</span></a></a><span> </span><a name="local-6989586621679047301"><a href="#local-6989586621679047301"><span class="hs-identifier">hdl</span></a></a><span> </span><a name="local-6989586621679047302"><a href="#local-6989586621679047302"><span class="hs-identifier">evs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-406"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#writeConsoleInputWith"><span class="hs-identifier hs-var">writeConsoleInputWith</span></a><span> </span><a href="#local-6989586621679047301"><span class="hs-identifier hs-var">hdl</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047303"><a href="#local-6989586621679047303"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">withArrayLen</span><span> </span><a href="#local-6989586621679047302"><span class="hs-identifier hs-var">evs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047380"><a href="#local-6989586621679047380"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679047381"><a href="#local-6989586621679047381"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047303"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047381"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><a href="#local-6989586621679047380"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-identifier">writeConsoleInputWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputHandler"><span class="hs-identifier hs-type">InputHandler</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-409"></a><a name="writeConsoleInputWith"><a href="System.Console.ANSI.Windows.Foreign.html#writeConsoleInputWith"><span class="hs-identifier">writeConsoleInputWith</span></a></a><span> </span><a name="local-6989586621679047382"><a href="#local-6989586621679047382"><span class="hs-identifier">hdl</span></a></a><span> </span><a name="local-6989586621679047383"><a href="#local-6989586621679047383"><span class="hs-identifier">withBuffer</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-410"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#returnWith_"><span class="hs-identifier hs-var">returnWith_</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047384"><a href="#local-6989586621679047384"><span class="hs-identifier">ptrN</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-411"></a><span>        </span><a href="#local-6989586621679047383"><span class="hs-identifier hs-var">withBuffer</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679047385"><a href="#local-6989586621679047385"><span class="hs-identifier">ptrBuf</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047386"><a href="#local-6989586621679047386"><span class="hs-identifier">len</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-412"></a><span>            </span><span class="hs-identifier hs-var">failIfFalse_</span><span> </span><span class="hs-string">&quot;WriteConsoleInputW&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cWriteConsoleInput"><span class="hs-identifier hs-var">cWriteConsoleInput</span></a><span> </span><a href="#local-6989586621679047382"><span class="hs-identifier hs-var">hdl</span></a><span> </span><a href="#local-6989586621679047385"><span class="hs-identifier hs-var">ptrBuf</span></a><span> </span><a href="#local-6989586621679047386"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621679047384"><span class="hs-identifier hs-var">ptrN</span></a><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span class="hs-identifier">returnWith_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="#local-6989586621679047139"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="#local-6989586621679047139"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679047140"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679047139"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-415"></a><a name="returnWith_"><a href="System.Console.ANSI.Windows.Foreign.html#returnWith_"><span class="hs-identifier">returnWith_</span></a></a><span> </span><a name="local-6989586621679047387"><a href="#local-6989586621679047387"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047388"><a href="#local-6989586621679047388"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679047387"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-6989586621679047388"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047388"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-keyword">type</span><span> </span><a name="InputHandler"><a href="System.Console.ANSI.Windows.Foreign.html#InputHandler"><span class="hs-identifier">InputHandler</span></a></a><span> </span><a name="local-6989586621679046592"><a href="#local-6989586621679046592"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679046593"><a href="#local-6989586621679046593"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679046592"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679046593"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679046593"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">{-
typedef union _UNICODE_ASCII_CHAR {
    WCHAR UnicodeChar;
    CHAR  AsciiChar;
} UNICODE_ASCII_CHAR;
-}</span><span>
</span><a name="line-425"></a><span class="hs-keyword">newtype</span><span> </span><a name="UNICODE_ASCII_CHAR"><a href="System.Console.ANSI.Windows.Foreign.html#UNICODE_ASCII_CHAR"><span class="hs-identifier">UNICODE_ASCII_CHAR</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a name="UnicodeAsciiChar"><a href="System.Console.ANSI.Windows.Foreign.html#UnicodeAsciiChar"><span class="hs-identifier">UnicodeAsciiChar</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unicodeAsciiChar"><a href="System.Console.ANSI.Windows.Foreign.html#unicodeAsciiChar"><span class="hs-identifier">unicodeAsciiChar</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WCHAR"><span class="hs-identifier hs-type">WCHAR</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-426"></a><span>                               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#UNICODE_ASCII_CHAR"><span class="hs-identifier hs-type">UNICODE_ASCII_CHAR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-429"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-430"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-431"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046931"><a href="#local-6989586621679046931"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#UnicodeAsciiChar"><span class="hs-identifier hs-var">UnicodeAsciiChar</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046931"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-432"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046932"><a href="#local-6989586621679046932"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046933"><a href="#local-6989586621679046933"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679046933"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-433"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#UnicodeAsciiChar"><span class="hs-identifier hs-var">UnicodeAsciiChar</span></a><span> </span><a name="local-6989586621679046934"><a href="#local-6989586621679046934"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046932"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046934"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-comment">{-
typedef struct _KEY_EVENT_RECORD {
	BOOL bKeyDown;
	WORD wRepeatCount;
	WORD wVirtualKeyCode;
	WORD wVirtualScanCode;
	union {
		WCHAR UnicodeChar;
		CHAR AsciiChar;
	} uChar;
	DWORD dwControlKeyState;
}
#ifdef __GNUC__
/* gcc's alignment is not what win32 expects */
 PACKED
#endif
KEY_EVENT_RECORD;
-}</span><span>
</span><a name="line-453"></a><span class="hs-keyword">data</span><span> </span><a name="KEY_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier">KEY_EVENT_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="KEY_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier">KEY_EVENT_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-454"></a><span>        </span><a name="keyEventKeyDown"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventKeyDown"><span class="hs-identifier">keyEventKeyDown</span></a></a><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">BOOL</span><span class="hs-special">,</span><span>
</span><a name="line-455"></a><span>        </span><a name="keyEventRepeatCount"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventRepeatCount"><span class="hs-identifier">keyEventRepeatCount</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span>
</span><a name="line-456"></a><span>        </span><a name="keyEventVirtualKeyCode"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventVirtualKeyCode"><span class="hs-identifier">keyEventVirtualKeyCode</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span>
</span><a name="line-457"></a><span>        </span><a name="keyEventVirtualScanCode"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventVirtualScanCode"><span class="hs-identifier">keyEventVirtualScanCode</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span>
</span><a name="line-458"></a><span>        </span><a name="keyEventChar"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventChar"><span class="hs-identifier">keyEventChar</span></a></a><span>            </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#UNICODE_ASCII_CHAR"><span class="hs-identifier hs-type">UNICODE_ASCII_CHAR</span></a><span class="hs-special">,</span><span>
</span><a name="line-459"></a><span>        </span><a name="keyEventControlKeystate"><a href="System.Console.ANSI.Windows.Foreign.html#keyEventControlKeystate"><span class="hs-identifier">keyEventControlKeystate</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-460"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier hs-type">KEY_EVENT_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-464"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">4</span><span>
</span><a name="line-465"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046928"><a href="#local-6989586621679046928"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier hs-var">KEY_EVENT_RECORD</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-466"></a><span>                                </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-467"></a><span>                                </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">6</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-468"></a><span>                                </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-469"></a><span>                                </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-470"></a><span>                                </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046928"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-471"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046929"><a href="#local-6989586621679046929"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046930"><a href="#local-6989586621679046930"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-472"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventKeyDown</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-473"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventRepeatCount</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-474"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">6</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventVirtualKeyCode</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-475"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventVirtualScanCode</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-476"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventChar</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-477"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046929"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">keyEventControlKeystate</span><span> </span><a href="#local-6989586621679046930"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-comment">{-
typedef struct _MOUSE_EVENT_RECORD {
	COORD dwMousePosition;
	DWORD dwButtonState;
	DWORD dwControlKeyState;
	DWORD dwEventFlags;
} MOUSE_EVENT_RECORD;
-}</span><span>
</span><a name="line-487"></a><span class="hs-keyword">data</span><span> </span><a name="MOUSE_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#MOUSE_EVENT_RECORD"><span class="hs-identifier">MOUSE_EVENT_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MOUSE_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#MOUSE_EVENT_RECORD"><span class="hs-identifier">MOUSE_EVENT_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-488"></a><span>        </span><a name="mousePosition"><a href="System.Console.ANSI.Windows.Foreign.html#mousePosition"><span class="hs-identifier">mousePosition</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span class="hs-special">,</span><span>
</span><a name="line-489"></a><span>        </span><a name="mouseButtonState"><a href="System.Console.ANSI.Windows.Foreign.html#mouseButtonState"><span class="hs-identifier">mouseButtonState</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">,</span><span>
</span><a name="line-490"></a><span>        </span><a name="mouseControlKeyState"><a href="System.Console.ANSI.Windows.Foreign.html#mouseControlKeyState"><span class="hs-identifier">mouseControlKeyState</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">,</span><span>
</span><a name="line-491"></a><span>        </span><a name="mouseEventFlags"><a href="System.Console.ANSI.Windows.Foreign.html#mouseEventFlags"><span class="hs-identifier">mouseEventFlags</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#MOUSE_EVENT_RECORD"><span class="hs-identifier hs-type">MOUSE_EVENT_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-495"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-496"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">4</span><span>
</span><a name="line-497"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046925"><a href="#local-6989586621679046925"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-498"></a><span>        </span><a href="System.Console.ANSI.Windows.Foreign.html#MOUSE_EVENT_RECORD"><span class="hs-identifier hs-var">MOUSE_EVENT_RECORD</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046925"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-499"></a><span>                           </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046925"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-500"></a><span>                           </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046925"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-501"></a><span>                           </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046925"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-502"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046926"><a href="#local-6989586621679046926"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046927"><a href="#local-6989586621679046927"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-503"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046926"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mousePosition</span><span> </span><a href="#local-6989586621679046927"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-504"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046926"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mouseButtonState</span><span> </span><a href="#local-6989586621679046927"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-505"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span>  </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046926"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mouseControlKeyState</span><span> </span><a href="#local-6989586621679046927"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-506"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">12</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046926"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">mouseEventFlags</span><span> </span><a href="#local-6989586621679046927"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span class="hs-comment">{-
typedef struct _WINDOW_BUFFER_SIZE_RECORD {
    COORD dwSize;
} WINDOW_BUFFER_SIZE_RECORD;
-}</span><span>
</span><a name="line-513"></a><span class="hs-keyword">data</span><span> </span><a name="WINDOW_BUFFER_SIZE_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#WINDOW_BUFFER_SIZE_RECORD"><span class="hs-identifier">WINDOW_BUFFER_SIZE_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WINDOW_BUFFER_SIZE_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#WINDOW_BUFFER_SIZE_RECORD"><span class="hs-identifier">WINDOW_BUFFER_SIZE_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-514"></a><span>        </span><a name="bufSizeNew"><a href="System.Console.ANSI.Windows.Foreign.html#bufSizeNew"><span class="hs-identifier">bufSizeNew</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#COORD"><span class="hs-identifier hs-type">COORD</span></a><span>
</span><a name="line-515"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>
</span><a name="line-517"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WINDOW_BUFFER_SIZE_RECORD"><span class="hs-identifier hs-type">WINDOW_BUFFER_SIZE_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-518"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-519"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-520"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046922"><a href="#local-6989586621679046922"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WINDOW_BUFFER_SIZE_RECORD"><span class="hs-identifier hs-var">WINDOW_BUFFER_SIZE_RECORD</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046922"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-521"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046923"><a href="#local-6989586621679046923"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046924"><a href="#local-6989586621679046924"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046923"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">bufSizeNew</span><span> </span><a href="#local-6989586621679046924"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-522"></a><span>
</span><a name="line-523"></a><span class="hs-comment">{-
typedef struct _MENU_EVENT_RECORD {
    UINT dwCommandId;
} MENU_EVENT_RECORD,*PMENU_EVENT_RECORD;
-}</span><span>
</span><a name="line-528"></a><span class="hs-keyword">data</span><span> </span><a name="MENU_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#MENU_EVENT_RECORD"><span class="hs-identifier">MENU_EVENT_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MENU_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#MENU_EVENT_RECORD"><span class="hs-identifier">MENU_EVENT_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-529"></a><span>        </span><a name="menuCommandId"><a href="System.Console.ANSI.Windows.Foreign.html#menuCommandId"><span class="hs-identifier">menuCommandId</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">UINT</span><span>
</span><a name="line-530"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#MENU_EVENT_RECORD"><span class="hs-identifier hs-type">MENU_EVENT_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-533"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-534"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-535"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046919"><a href="#local-6989586621679046919"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#MENU_EVENT_RECORD"><span class="hs-identifier hs-var">MENU_EVENT_RECORD</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046919"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-536"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046920"><a href="#local-6989586621679046920"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046921"><a href="#local-6989586621679046921"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046920"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">menuCommandId</span><span> </span><a href="#local-6989586621679046921"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-comment">{-
typedef struct _FOCUS_EVENT_RECORD { BOOL bSetFocus; } FOCUS_EVENT_RECORD;
-}</span><span>
</span><a name="line-541"></a><span class="hs-keyword">data</span><span> </span><a name="FOCUS_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#FOCUS_EVENT_RECORD"><span class="hs-identifier">FOCUS_EVENT_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FOCUS_EVENT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#FOCUS_EVENT_RECORD"><span class="hs-identifier">FOCUS_EVENT_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-542"></a><span>        </span><a name="focusSetFocus"><a href="System.Console.ANSI.Windows.Foreign.html#focusSetFocus"><span class="hs-identifier">focusSetFocus</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">BOOL</span><span>
</span><a name="line-543"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>
</span><a name="line-545"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#FOCUS_EVENT_RECORD"><span class="hs-identifier hs-type">FOCUS_EVENT_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-546"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-547"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-548"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046916"><a href="#local-6989586621679046916"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#FOCUS_EVENT_RECORD"><span class="hs-identifier hs-var">FOCUS_EVENT_RECORD</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046916"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-549"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046917"><a href="#local-6989586621679046917"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046918"><a href="#local-6989586621679046918"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046917"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">focusSetFocus</span><span> </span><a href="#local-6989586621679046918"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-keyword">data</span><span> </span><a name="INPUT_RECORD_EVENT"><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD_EVENT"><span class="hs-identifier">INPUT_RECORD_EVENT</span></a></a><span>
</span><a name="line-552"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="InputKeyEvent"><a href="System.Console.ANSI.Windows.Foreign.html#InputKeyEvent"><span class="hs-identifier">InputKeyEvent</span></a></a><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#KEY_EVENT_RECORD"><span class="hs-identifier hs-type">KEY_EVENT_RECORD</span></a><span>
</span><a name="line-553"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="InputMouseEvent"><a href="System.Console.ANSI.Windows.Foreign.html#InputMouseEvent"><span class="hs-identifier">InputMouseEvent</span></a></a><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#MOUSE_EVENT_RECORD"><span class="hs-identifier hs-type">MOUSE_EVENT_RECORD</span></a><span>
</span><a name="line-554"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="InputWindowBufferSizeEvent"><a href="System.Console.ANSI.Windows.Foreign.html#InputWindowBufferSizeEvent"><span class="hs-identifier">InputWindowBufferSizeEvent</span></a></a><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#WINDOW_BUFFER_SIZE_RECORD"><span class="hs-identifier hs-type">WINDOW_BUFFER_SIZE_RECORD</span></a><span>
</span><a name="line-555"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="InputMenuEvent"><a href="System.Console.ANSI.Windows.Foreign.html#InputMenuEvent"><span class="hs-identifier">InputMenuEvent</span></a></a><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#MENU_EVENT_RECORD"><span class="hs-identifier hs-type">MENU_EVENT_RECORD</span></a><span>
</span><a name="line-556"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="InputFocusEvent"><a href="System.Console.ANSI.Windows.Foreign.html#InputFocusEvent"><span class="hs-identifier">InputFocusEvent</span></a></a><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#FOCUS_EVENT_RECORD"><span class="hs-identifier hs-type">FOCUS_EVENT_RECORD</span></a><span>
</span><a name="line-557"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-comment">{-
typedef struct _INPUT_RECORD {
	WORD EventType;
	union {
		KEY_EVENT_RECORD KeyEvent;
		MOUSE_EVENT_RECORD MouseEvent;
		WINDOW_BUFFER_SIZE_RECORD WindowBufferSizeEvent;
		MENU_EVENT_RECORD MenuEvent;
		FOCUS_EVENT_RECORD FocusEvent;
	} Event;
} INPUT_RECORD,*PINPUT_RECORD;
-}</span><span>
</span><a name="line-571"></a><span class="hs-keyword">data</span><span> </span><a name="INPUT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier">INPUT_RECORD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="INPUT_RECORD"><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier">INPUT_RECORD</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-572"></a><span>        </span><a name="inputEventType"><a href="System.Console.ANSI.Windows.Foreign.html#inputEventType"><span class="hs-identifier">inputEventType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">WORD</span><span class="hs-special">,</span><span>
</span><a name="line-573"></a><span>        </span><a name="inputEvent"><a href="System.Console.ANSI.Windows.Foreign.html#inputEvent"><span class="hs-identifier">inputEvent</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD_EVENT"><span class="hs-identifier hs-type">INPUT_RECORD_EVENT</span></a><span>
</span><a name="line-574"></a><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Storable</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-577"></a><span>    </span><a name="local-8214565720323792651"><span class="hs-identifier">sizeOf</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">20</span><span>
</span><a name="line-578"></a><span>    </span><a name="local-8214565720323792650"><span class="hs-identifier">alignment</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">4</span><span>
</span><a name="line-579"></a><span>    </span><a name="local-8214565720323792645"><span class="hs-identifier">peek</span></a><span> </span><a name="local-6989586621679046906"><a href="#local-6989586621679046906"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-580"></a><span>        </span><a name="local-6989586621679046907"><a href="#local-6989586621679046907"><span class="hs-identifier">evType</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-581"></a><span>        </span><a name="local-6989586621679046908"><a href="#local-6989586621679046908"><span class="hs-identifier">event</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-582"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#kEY_EVENT"><span class="hs-identifier hs-var">kEY_EVENT</span></a><span>
</span><a name="line-583"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputKeyEvent"><span class="hs-identifier hs-var">InputKeyEvent</span></a><span>              </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-584"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#mOUSE_EVENT"><span class="hs-identifier hs-var">mOUSE_EVENT</span></a><span>
</span><a name="line-585"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputMouseEvent"><span class="hs-identifier hs-var">InputMouseEvent</span></a><span>            </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-586"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#wINDOW_BUFFER_SIZE_EVENT"><span class="hs-identifier hs-var">wINDOW_BUFFER_SIZE_EVENT</span></a><span>
</span><a name="line-587"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputWindowBufferSizeEvent"><span class="hs-identifier hs-var">InputWindowBufferSizeEvent</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-588"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#mENU_EVENT"><span class="hs-identifier hs-var">mENU_EVENT</span></a><span>
</span><a name="line-589"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputMenuEvent"><span class="hs-identifier hs-var">InputMenuEvent</span></a><span>             </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-590"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#fOCUS_EVENT"><span class="hs-identifier hs-var">fOCUS_EVENT</span></a><span>
</span><a name="line-591"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#InputFocusEvent"><span class="hs-identifier hs-var">InputFocusEvent</span></a><span>            </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">peekByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046906"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-592"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;peek (INPUT_RECORD): Unknown event type &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span>
</span><a name="line-593"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-var">INPUT_RECORD</span></a><span> </span><a href="#local-6989586621679046907"><span class="hs-identifier hs-var">evType</span></a><span> </span><a href="#local-6989586621679046908"><span class="hs-identifier hs-var">event</span></a><span>
</span><a name="line-594"></a><span>    </span><a name="local-8214565720323792644"><span class="hs-identifier">poke</span></a><span> </span><a name="local-6989586621679046909"><a href="#local-6989586621679046909"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679046910"><a href="#local-6989586621679046910"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-595"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">inputEventType</span><span> </span><a href="#local-6989586621679046910"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-596"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">inputEvent</span><span> </span><a href="#local-6989586621679046910"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-597"></a><span>            </span><a href="System.Console.ANSI.Windows.Foreign.html#InputKeyEvent"><span class="hs-identifier hs-var">InputKeyEvent</span></a><span>              </span><a name="local-6989586621679046911"><a href="#local-6989586621679046911"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046911"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-598"></a><span>            </span><a href="System.Console.ANSI.Windows.Foreign.html#InputMouseEvent"><span class="hs-identifier hs-var">InputMouseEvent</span></a><span>            </span><a name="local-6989586621679046912"><a href="#local-6989586621679046912"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046912"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-599"></a><span>            </span><a href="System.Console.ANSI.Windows.Foreign.html#InputWindowBufferSizeEvent"><span class="hs-identifier hs-var">InputWindowBufferSizeEvent</span></a><span> </span><a name="local-6989586621679046913"><a href="#local-6989586621679046913"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046913"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-600"></a><span>            </span><a href="System.Console.ANSI.Windows.Foreign.html#InputMenuEvent"><span class="hs-identifier hs-var">InputMenuEvent</span></a><span>             </span><a name="local-6989586621679046914"><a href="#local-6989586621679046914"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046914"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-601"></a><span>            </span><a href="System.Console.ANSI.Windows.Foreign.html#InputFocusEvent"><span class="hs-identifier hs-var">InputFocusEvent</span></a><span>            </span><a name="local-6989586621679046915"><a href="#local-6989586621679046915"><span class="hs-identifier">ev</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">pokeByteOff</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046909"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679046915"><span class="hs-identifier hs-var">ev</span></a><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-comment">-- The following is based on module System.Win32.Console.Extra from package</span><span>
</span><a name="line-604"></a><span class="hs-comment">-- Win32-console.</span><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-identifier">getNumberOfConsoleInputEvents</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span>
</span><a name="line-607"></a><a name="getNumberOfConsoleInputEvents"><a href="System.Console.ANSI.Windows.Foreign.html#getNumberOfConsoleInputEvents"><span class="hs-identifier">getNumberOfConsoleInputEvents</span></a></a><span> </span><a name="local-6989586621679047389"><a href="#local-6989586621679047389"><span class="hs-identifier">hdl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-608"></a><span>    </span><a href="System.Console.ANSI.Windows.Foreign.html#returnWith_"><span class="hs-identifier hs-var">returnWith_</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047390"><a href="#local-6989586621679047390"><span class="hs-identifier">ptrN</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-609"></a><span>        </span><span class="hs-identifier hs-var">failIfFalse_</span><span> </span><span class="hs-string">&quot;GetNumberOfConsoleInputEvents&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cGetNumberOfConsoleInputEvents"><span class="hs-identifier hs-var">cGetNumberOfConsoleInputEvents</span></a><span> </span><a href="#local-6989586621679047389"><span class="hs-identifier hs-var">hdl</span></a><span> </span><a href="#local-6989586621679047390"><span class="hs-identifier hs-var">ptrN</span></a><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">-- The following is based on module System.Win32.Console.Extra from package</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- Win32-console, cut down for the WCHAR version of readConsoleInput.</span><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-identifier">readConsoleInput</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span class="hs-special">]</span><span>
</span><a name="line-615"></a><a name="readConsoleInput"><a href="System.Console.ANSI.Windows.Foreign.html#readConsoleInput"><span class="hs-identifier">readConsoleInput</span></a></a><span> </span><a name="local-6989586621679047391"><a href="#local-6989586621679047391"><span class="hs-identifier">hdl</span></a></a><span> </span><a name="local-6989586621679047392"><a href="#local-6989586621679047392"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#readConsoleInputWith"><span class="hs-identifier hs-var">readConsoleInputWith</span></a><span> </span><a href="#local-6989586621679047391"><span class="hs-identifier hs-var">hdl</span></a><span> </span><a href="#local-6989586621679047392"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679047393"><a href="#local-6989586621679047393"><span class="hs-identifier">ptr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679047394"><a href="#local-6989586621679047394"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">peekArray</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679047394"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679047393"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-identifier">readConsoleInputWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#OutputHandler"><span class="hs-identifier hs-type">OutputHandler</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#INPUT_RECORD"><span class="hs-identifier hs-type">INPUT_RECORD</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DWORD</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><a name="readConsoleInputWith"><a href="System.Console.ANSI.Windows.Foreign.html#readConsoleInputWith"><span class="hs-identifier">readConsoleInputWith</span></a></a><span> </span><a name="local-6989586621679047395"><a href="#local-6989586621679047395"><span class="hs-identifier">hdl</span></a></a><span> </span><a name="local-6989586621679047396"><a href="#local-6989586621679047396"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679047397"><a href="#local-6989586621679047397"><span class="hs-identifier">handler</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-619"></a><span>    </span><span class="hs-identifier hs-var">allocaArray</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679047396"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047398"><a href="#local-6989586621679047398"><span class="hs-identifier">ptrBuf</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-620"></a><span>        </span><span class="hs-identifier hs-var">alloca</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679047399"><a href="#local-6989586621679047399"><span class="hs-identifier">ptrN</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-621"></a><span>            </span><span class="hs-identifier hs-var">failIfFalse_</span><span> </span><span class="hs-string">&quot;ReadConsoleInputW&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.ANSI.Windows.Foreign.html#cReadConsoleInput"><span class="hs-identifier hs-var">cReadConsoleInput</span></a><span> </span><a href="#local-6989586621679047395"><span class="hs-identifier hs-var">hdl</span></a><span> </span><a href="#local-6989586621679047398"><span class="hs-identifier hs-var">ptrBuf</span></a><span> </span><a href="#local-6989586621679047396"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621679047399"><span class="hs-identifier hs-var">ptrN</span></a><span>
</span><a name="line-622"></a><span>            </span><a name="local-6989586621679047400"><a href="#local-6989586621679047400"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">peek</span><span> </span><a href="#local-6989586621679047399"><span class="hs-identifier hs-var">ptrN</span></a><span>
</span><a name="line-623"></a><span>            </span><a href="#local-6989586621679047397"><span class="hs-identifier hs-var">handler</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047398"><span class="hs-identifier hs-var">ptrBuf</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679047400"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-keyword">type</span><span> </span><a name="OutputHandler"><a href="System.Console.ANSI.Windows.Foreign.html#OutputHandler"><span class="hs-identifier">OutputHandler</span></a></a><span> </span><a name="local-6989586621679046590"><a href="#local-6989586621679046590"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679046591"><a href="#local-6989586621679046591"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679046590"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679046591"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679046591"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-comment">-- Replicated from module Foreign.C.String in package base because that module</span><span>
</span><a name="line-628"></a><span class="hs-comment">-- does not export the function.</span><span>
</span><a name="line-629"></a><span class="hs-identifier">cWcharsToChars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">CWchar</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Char</span><span class="hs-special">]</span><span>
</span><a name="line-630"></a><a name="cWcharsToChars"><a href="System.Console.ANSI.Windows.Foreign.html#cWcharsToChars"><span class="hs-identifier">cWcharsToChars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">chr</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679047401"><span class="hs-identifier hs-var">fromUTF16</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span>
</span><a name="line-631"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-632"></a><span>  </span><a name="local-6989586621679047401"><a href="#local-6989586621679047401"><span class="hs-identifier">fromUTF16</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679047402"><a href="#local-6989586621679047402"><span class="hs-identifier">c1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679047403"><a href="#local-6989586621679047403"><span class="hs-identifier">c2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679047404"><a href="#local-6989586621679047404"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">0xd800</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679047402"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679047402"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0xdbff</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-number">0xdc00</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679047403"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679047403"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0xdfff</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-634"></a><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679047402"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0xd800</span><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-number">0x400</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679047403"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0xdc00</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">0x10000</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679047401"><span class="hs-identifier hs-var">fromUTF16</span></a><span> </span><a href="#local-6989586621679047404"><span class="hs-identifier hs-var">wcs</span></a><span>
</span><a name="line-635"></a><span>  </span><span class="hs-identifier">fromUTF16</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679047405"><a href="#local-6989586621679047405"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679047406"><a href="#local-6989586621679047406"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679047405"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679047401"><span class="hs-identifier hs-var">fromUTF16</span></a><span> </span><a href="#local-6989586621679047406"><span class="hs-identifier hs-var">wcs</span></a><span>
</span><a name="line-636"></a><span>  </span><span class="hs-identifier">fromUTF16</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-637"></a></pre></body></html>